<!doctype html>
<head>
    <title>Visibily</title>
	<meta http-equiv="X-UA-Compatible" content="IE=9" />
    <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css"
    >
	<style>
	html,body { height: 100%; }
	body {
		padding: 0px;
		margin: 0px;
		height: 100%;
		width: 100%;
		overflow: hidden;
		font-family:Helvetica,"Bitstream Vera Sans",Arial,sans-serif;
		background-color: #fff;
	}
	#map { height:600px; width: 1200px; position:relative; }
    input {
        width: 100%;
    }
    datalist {
        display: flex;
        justify-content: space-between;
        }
	</style>
	<script src="https://code.jquery.com/jquery-3.4.1.min.js" type="text/javascript"></script>
	<script src="nite-overlay.js" type="text/javascript"></script>
	<script>
        const globaltime = new Date();
        let now = globaltime;
        //Create worldmap
        let map;

        window.onload = function() {
          initMap();
          updateDate(now) 
          var deltat = document.getElementById("time");
          var deltad = document.getElementById("date");

          deltat.addEventListener('click', () => {
            let timestamp = new Date(now);
            let hours = timestamp.getHours() + parseInt(deltat.value) ;
            console.log(now)
            timestamp.setHours(hours)
            console.log(deltat.value, hours, timestamp);
            nite.setDate(timestamp);
            updateDate(timestamp);
          });

          deltad.addEventListener('click', () => {
            let timestamp = new Date(globaltime);
            console.log(deltad.value);
            timestamp.setDate(timestamp.getDate() + parseInt(deltad.value));
            nite.setDate(timestamp);
            updateDate(timestamp)
            now = timestamp;
          });

        }


        function updateDate(date) {
            document.getElementById("currentdate").innerHTML = date.toLocaleString()
        }
        function initMap() {
             
            //Default settings, settings can be changed here
            map = new google.maps.Map(document.getElementById('map'),
                {
                    center: { lat: 0, lng: 0 },
                    zoom: 2,
                    disableDefaultUI: true,
                });                

            nite.init(map);
        }
	</script>
</head>
<body>

    <section class="section">
        <div class="container">
            <h1 class="title">Visibily</h1>
            <div id="map"></div>
            <div class="content">
                <p>Current Date:
                    <span id="currentdate"></span>
                </p>
            </div>
        </div>
        <div class="container">
            <div class="columns">
                <div class="column">
                    <input type="range" id="time" min="0" max="24" value="0" list="tickmarks"/>
                    <datalist id="tickmarks">
                        <option value="0" label="0"></option>
                        <option value="12" label="12"></option>
                        <option value="24" label="24"></option>
                    </datalist>
                </div>
            <div class="column">
                <input type="range" id="date" min="0" max="360" list="date-ticks" value="0"/>
                <datalist id="date-ticks">
                    <option value="0" label="0"></option>
                    <option value="180" label="6 months"></option>
                    <option value="360" label="1 year"></option>
            </div>
            </div>
        </div>
      </section>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBrxal5uPuRmcbRiIZiiVYQU2F5GSrRG34&callback=initMap&libraries=marker" defer></script>
</body>
</html>
